- name: uninstall docker
  yum:
    name: ['docker', 'docker-client', 'docker-client-latest', 'docker-common', 'docker-latest', 'docker-latest-logrotate', 'docker-logrotate', 'docker-selinux', 'docker-engine-selinux', 'docker-engine']
    state: absent

- name: install required packages for docker-ce
  yum:
    name: ['yum-utils', 'device-mapper-persistent-data', 'lvm2']
    state: present

- name: add docker stable repository
  yum_repository:
    name: docker-ce
    description: Docker CE official repository
    baseurl: "https://download.docker.com/linux/{{ ansible_distribution|lower }}/$releasever/$basearch/"

- name: disable docker-ce-edge
  command: "yum-config-manager --disable docker-ce-edge"

- name: disable docker-ce-test
  command: "yum-config-manager --disable docker-ce-test"

# - name: make cache
#   command: "yum makecache fast"
#   when: ansible_os_family == "RedHat"
